{"ast":null,"code":"import { Renderer2 } from '@angular/core';\nimport { ApiService } from '../api.service';\nimport { SqliteService } from '../sqlite.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../api.service\";\nimport * as i2 from \"../sqlite.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@ionic/angular\";\nfunction OfficialDepartmentsPage_ion_card_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-card\");\n    i0.ɵɵelement(1, \"ion-card-content\", 3);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const data_r1 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"innerHTML\", data_r1.content, i0.ɵɵsanitizeHtml);\n  }\n}\nexport let OfficialDepartmentsPage = /*#__PURE__*/(() => {\n  class OfficialDepartmentsPage {\n    constructor(api, sqLite, renderer) {\n      this.api = api;\n      this.sqLite = sqLite;\n      this.renderer = renderer;\n      this.officialDepartments = [];\n    }\n    ngOnInit() {}\n    ionViewDidEnter() {\n      this.getApiData();\n    }\n    getApiData(isRefresher = false) {\n      const api = this.api.get('/official-departments');\n      api.subscribe(next => {\n        this.officialDepartments = next.data.officialDepartments;\n        let allLinks = document.querySelectorAll('a');\n        let intervalForDom;\n        if (allLinks.length === 0) {\n          intervalForDom = setInterval(() => {\n            allLinks = document.querySelectorAll('a');\n            if (allLinks.length > 0) {\n              this.hrefFunctions();\n              clearInterval(intervalForDom);\n            }\n          }, 500);\n        }\n        this.sqLite.db.executeSql('SELECT * FROM api_content WHERE api_path = ?', ['official-departments']).then(data => {\n          if (data.rows.length > 1 || data.rows.length < 1) {\n            this.sqLite.db.executeSql('DELETE FROM api_content WHERE api_path = ?', ['official-departments']).then(() => {\n              this.sqLite.db.executeSql('INSERT INTO api_content (api_path, api_data) VALUES(?,?)', ['official-departments', JSON.stringify(this.officialDepartments)]).then(() => {}).catch(ei => console.log('#insert dberror: ' + JSON.stringify(ei)));\n            }).catch(ed => console.log('#delete dberror: ' + JSON.stringify(ed)));\n          } else {\n            this.sqLite.db.executeSql('UPDATE api_content SET api_data = ? WHERE api_path = ?', [JSON.stringify(this.officialDepartments), 'official-departments']).then(() => {}).catch(eu => console.log('#update dberror: ' + JSON.stringify(eu)));\n          }\n        }).catch(es => {\n          console.log('#select dberror: ' + JSON.stringify(es));\n        });\n      }, error => {\n        console.log(error);\n        this.sqLite.db.executeSql('SELECT * FROM api_content WHERE api_path = ?', ['official-departments']).then(data => {\n          for (let i = 0; i < data.rows.length; i++) {\n            this.officialDepartments = JSON.parse(data.rows.item(i).api_data);\n          }\n        }).catch(es => console.log('#select error: ' + JSON.stringify(es)));\n      });\n    }\n    hrefFunctions() {\n      const allLinks = document.querySelectorAll('a');\n      for (let i = 0; i < allLinks.length; i++) {\n        let el;\n        this.renderer.listen(allLinks.item(i), 'click', event => {\n          el = event.target;\n          if (typeof el.href === 'undefined') {\n            event.path.forEach((val, key) => {\n              if (typeof val.href !== 'undefined') {\n                el = val;\n              }\n            });\n          }\n          if (el.href.indexOf('mailto:') === -1 && el.href.indexOf('tel:') === -1) {\n            this.api.openUrl(el.href);\n            return false;\n          }\n        });\n      }\n    }\n  }\n  OfficialDepartmentsPage.ɵfac = function OfficialDepartmentsPage_Factory(t) {\n    return new (t || OfficialDepartmentsPage)(i0.ɵɵdirectiveInject(i1.ApiService), i0.ɵɵdirectiveInject(i2.SqliteService), i0.ɵɵdirectiveInject(i0.Renderer2));\n  };\n  OfficialDepartmentsPage.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: OfficialDepartmentsPage,\n    selectors: [[\"app-official-departments\"]],\n    decls: 8,\n    vars: 2,\n    consts: [[3, \"translucent\"], [\"slot\", \"start\"], [4, \"ngFor\", \"ngForOf\"], [3, \"innerHTML\"]],\n    template: function OfficialDepartmentsPage_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-header\", 0)(1, \"ion-toolbar\")(2, \"ion-buttons\", 1);\n        i0.ɵɵelement(3, \"ion-menu-button\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"ion-title\");\n        i0.ɵɵtext(5, \"Gemeinde Abteilungen\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(6, \"ion-content\");\n        i0.ɵɵtemplate(7, OfficialDepartmentsPage_ion_card_7_Template, 2, 1, \"ion-card\", 2);\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"translucent\", true);\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngForOf\", ctx.officialDepartments);\n      }\n    },\n    dependencies: [i3.NgForOf, i4.IonButtons, i4.IonCard, i4.IonCardContent, i4.IonContent, i4.IonHeader, i4.IonMenuButton, i4.IonTitle, i4.IonToolbar]\n  });\n  return OfficialDepartmentsPage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}