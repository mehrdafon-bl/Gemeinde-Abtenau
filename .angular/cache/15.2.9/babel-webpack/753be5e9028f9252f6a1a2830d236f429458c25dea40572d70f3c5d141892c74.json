{"ast":null,"code":"\"use strict\";\n\nvar ɵngcc0 = require('@angular/core');\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = this && this.__metadata || function (k, v) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar core_1 = require(\"@angular/core\");\nvar moment = require(\"moment\");\nvar config_1 = require(\"../config\");\nvar calendar_options_provider_1 = require(\"./calendar-options.provider\");\nvar isBoolean = function (input) {\n  return input === true || input === false;\n};\nvar ɵ0 = isBoolean;\nexports.ɵ0 = ɵ0;\nvar CalendarService = /** @class */function () {\n  function CalendarService(defaultOpts) {\n    this.defaultOpts = defaultOpts;\n  }\n  Object.defineProperty(CalendarService.prototype, \"DEFAULT_STEP\", {\n    get: function () {\n      return 12;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  CalendarService.prototype.safeOpt = function (calendarOptions) {\n    if (calendarOptions === void 0) {\n      calendarOptions = {};\n    }\n    var _disableWeeks = [];\n    var _daysConfig = [];\n    var _a = __assign({}, this.defaultOpts, calendarOptions),\n      _b = _a.from,\n      from = _b === void 0 ? new Date() : _b,\n      _c = _a.to,\n      to = _c === void 0 ? 0 : _c,\n      _d = _a.weekStart,\n      weekStart = _d === void 0 ? 0 : _d,\n      _e = _a.step,\n      step = _e === void 0 ? this.DEFAULT_STEP : _e,\n      _f = _a.id,\n      id = _f === void 0 ? '' : _f,\n      _g = _a.cssClass,\n      cssClass = _g === void 0 ? '' : _g,\n      _h = _a.closeLabel,\n      closeLabel = _h === void 0 ? 'CANCEL' : _h,\n      _j = _a.doneLabel,\n      doneLabel = _j === void 0 ? 'DONE' : _j,\n      _k = _a.monthFormat,\n      monthFormat = _k === void 0 ? 'MMM YYYY' : _k,\n      _l = _a.title,\n      title = _l === void 0 ? 'CALENDAR' : _l,\n      _m = _a.defaultTitle,\n      defaultTitle = _m === void 0 ? '' : _m,\n      _o = _a.defaultSubtitle,\n      defaultSubtitle = _o === void 0 ? '' : _o,\n      _p = _a.autoDone,\n      autoDone = _p === void 0 ? false : _p,\n      _q = _a.canBackwardsSelected,\n      canBackwardsSelected = _q === void 0 ? false : _q,\n      _r = _a.closeIcon,\n      closeIcon = _r === void 0 ? false : _r,\n      _s = _a.doneIcon,\n      doneIcon = _s === void 0 ? false : _s,\n      _t = _a.showYearPicker,\n      showYearPicker = _t === void 0 ? false : _t,\n      _u = _a.isSaveHistory,\n      isSaveHistory = _u === void 0 ? false : _u,\n      _v = _a.pickMode,\n      pickMode = _v === void 0 ? config_1.pickModes.SINGLE : _v,\n      _w = _a.color,\n      color = _w === void 0 ? config_1.defaults.COLOR : _w,\n      _x = _a.weekdays,\n      weekdays = _x === void 0 ? config_1.defaults.WEEKS_FORMAT : _x,\n      _y = _a.daysConfig,\n      daysConfig = _y === void 0 ? _daysConfig : _y,\n      _z = _a.disableWeeks,\n      disableWeeks = _z === void 0 ? _disableWeeks : _z,\n      _0 = _a.showAdjacentMonthDay,\n      showAdjacentMonthDay = _0 === void 0 ? true : _0,\n      _1 = _a.defaultEndDateToStartDate,\n      defaultEndDateToStartDate = _1 === void 0 ? false : _1,\n      _2 = _a.clearLabel,\n      clearLabel = _2 === void 0 ? null : _2;\n    return {\n      id: id,\n      from: from,\n      to: to,\n      pickMode: pickMode,\n      autoDone: autoDone,\n      color: color,\n      cssClass: cssClass,\n      weekStart: weekStart,\n      closeLabel: closeLabel,\n      closeIcon: closeIcon,\n      doneLabel: doneLabel,\n      doneIcon: doneIcon,\n      canBackwardsSelected: canBackwardsSelected,\n      isSaveHistory: isSaveHistory,\n      disableWeeks: disableWeeks,\n      monthFormat: monthFormat,\n      title: title,\n      weekdays: weekdays,\n      daysConfig: daysConfig,\n      step: step,\n      showYearPicker: showYearPicker,\n      defaultTitle: defaultTitle,\n      defaultSubtitle: defaultSubtitle,\n      defaultScrollTo: calendarOptions.defaultScrollTo || from,\n      defaultDate: calendarOptions.defaultDate || null,\n      defaultDates: calendarOptions.defaultDates || null,\n      defaultDateRange: calendarOptions.defaultDateRange || null,\n      showAdjacentMonthDay: showAdjacentMonthDay,\n      defaultEndDateToStartDate: defaultEndDateToStartDate,\n      clearLabel: clearLabel\n    };\n  };\n  CalendarService.prototype.createOriginalCalendar = function (time) {\n    var date = new Date(time);\n    var year = date.getFullYear();\n    var month = date.getMonth();\n    var firstWeek = new Date(year, month, 1).getDay();\n    var howManyDays = moment(time).daysInMonth();\n    return {\n      year: year,\n      month: month,\n      firstWeek: firstWeek,\n      howManyDays: howManyDays,\n      time: new Date(year, month, 1).getTime(),\n      date: new Date(time)\n    };\n  };\n  CalendarService.prototype.findDayConfig = function (day, opt) {\n    if (opt.daysConfig.length <= 0) return null;\n    return opt.daysConfig.find(function (n) {\n      return day.isSame(n.date, 'day');\n    });\n  };\n  CalendarService.prototype.createCalendarDay = function (time, opt, month) {\n    var _time = moment(time);\n    var date = moment(time);\n    var isToday = moment().isSame(_time, 'days');\n    var dayConfig = this.findDayConfig(_time, opt);\n    var _rangeBeg = moment(opt.from).valueOf();\n    var _rangeEnd = moment(opt.to).valueOf();\n    var isBetween = true;\n    var disableWee = opt.disableWeeks.indexOf(_time.toDate().getDay()) !== -1;\n    if (_rangeBeg > 0 && _rangeEnd > 0) {\n      if (!opt.canBackwardsSelected) {\n        isBetween = !_time.isBetween(_rangeBeg, _rangeEnd, 'days', '[]');\n      } else {\n        isBetween = moment(_time).isBefore(_rangeBeg) ? false : isBetween;\n      }\n    } else if (_rangeBeg > 0 && _rangeEnd === 0) {\n      if (!opt.canBackwardsSelected) {\n        var _addTime = _time.add(1, 'day');\n        isBetween = !_addTime.isAfter(_rangeBeg);\n      } else {\n        isBetween = false;\n      }\n    }\n    var _disable = false;\n    if (dayConfig && isBoolean(dayConfig.disable)) {\n      _disable = dayConfig.disable;\n    } else {\n      _disable = disableWee || isBetween;\n    }\n    var title = new Date(time).getDate().toString();\n    if (dayConfig && dayConfig.title) {\n      title = dayConfig.title;\n    } else if (opt.defaultTitle) {\n      title = opt.defaultTitle;\n    }\n    var subTitle = '';\n    if (dayConfig && dayConfig.subTitle) {\n      subTitle = dayConfig.subTitle;\n    } else if (opt.defaultSubtitle) {\n      subTitle = opt.defaultSubtitle;\n    }\n    return {\n      time: time,\n      isToday: isToday,\n      title: title,\n      subTitle: subTitle,\n      selected: false,\n      isLastMonth: date.month() < month,\n      isNextMonth: date.month() > month,\n      marked: dayConfig ? dayConfig.marked || false : false,\n      cssClass: dayConfig ? dayConfig.cssClass || '' : '',\n      disable: _disable,\n      isFirst: date.date() === 1,\n      isLast: date.date() === date.daysInMonth()\n    };\n  };\n  CalendarService.prototype.createCalendarMonth = function (original, opt) {\n    var days = new Array(6).fill(null);\n    var len = original.howManyDays;\n    for (var i = original.firstWeek; i < len + original.firstWeek; i++) {\n      var itemTime = new Date(original.year, original.month, i - original.firstWeek + 1).getTime();\n      days[i] = this.createCalendarDay(itemTime, opt);\n    }\n    var weekStart = opt.weekStart;\n    if (weekStart === 1) {\n      if (days[0] === null) {\n        days.shift();\n      } else {\n        days.unshift.apply(days, new Array(6).fill(null));\n      }\n    }\n    if (opt.showAdjacentMonthDay) {\n      var _booleanMap = days.map(function (e) {\n        return !!e;\n      });\n      var thisMonth = moment(original.time).month();\n      var startOffsetIndex = _booleanMap.indexOf(true) - 1;\n      var endOffsetIndex = _booleanMap.lastIndexOf(true) + 1;\n      for (startOffsetIndex; startOffsetIndex >= 0; startOffsetIndex--) {\n        var dayBefore = moment(days[startOffsetIndex + 1].time).clone().subtract(1, 'd');\n        days[startOffsetIndex] = this.createCalendarDay(dayBefore.valueOf(), opt, thisMonth);\n      }\n      if (!(_booleanMap.length % 7 === 0 && _booleanMap[_booleanMap.length - 1])) {\n        for (endOffsetIndex; endOffsetIndex < days.length + endOffsetIndex % 7; endOffsetIndex++) {\n          var dayAfter = moment(days[endOffsetIndex - 1].time).clone().add(1, 'd');\n          days[endOffsetIndex] = this.createCalendarDay(dayAfter.valueOf(), opt, thisMonth);\n        }\n      }\n    }\n    return {\n      days: days,\n      original: original\n    };\n  };\n  CalendarService.prototype.createMonthsByPeriod = function (startTime, monthsNum, opt) {\n    var _array = [];\n    var _start = new Date(startTime);\n    var _startMonth = new Date(_start.getFullYear(), _start.getMonth(), 1).getTime();\n    for (var i = 0; i < monthsNum; i++) {\n      var time = moment(_startMonth).add(i, 'M').valueOf();\n      var originalCalendar = this.createOriginalCalendar(time);\n      _array.push(this.createCalendarMonth(originalCalendar, opt));\n    }\n    return _array;\n  };\n  CalendarService.prototype.wrapResult = function (original, pickMode) {\n    var _this = this;\n    var result;\n    switch (pickMode) {\n      case config_1.pickModes.SINGLE:\n        result = this.multiFormat(original[0].time);\n        break;\n      case config_1.pickModes.RANGE:\n        result = {\n          from: this.multiFormat(original[0].time),\n          to: this.multiFormat((original[1] || original[0]).time)\n        };\n        break;\n      case config_1.pickModes.MULTI:\n        result = original.map(function (e) {\n          return _this.multiFormat(e.time);\n        });\n        break;\n      default:\n        result = original;\n    }\n    return result;\n  };\n  CalendarService.prototype.multiFormat = function (time) {\n    var _moment = moment(time);\n    return {\n      time: _moment.valueOf(),\n      unix: _moment.unix(),\n      dateObj: _moment.toDate(),\n      string: _moment.format(config_1.defaults.DATE_FORMAT),\n      years: _moment.year(),\n      months: _moment.month() + 1,\n      date: _moment.date()\n    };\n  };\n  CalendarService = __decorate([__param(0, core_1.Optional()), __param(0, core_1.Inject(calendar_options_provider_1.DEFAULT_CALENDAR_OPTIONS)), __metadata(\"design:paramtypes\", [Object])], CalendarService);\n  CalendarService.ɵfac = function CalendarService_Factory(t) {\n    return new (t || CalendarService)(ɵngcc0.ɵɵinject(calendar_options_provider_1.DEFAULT_CALENDAR_OPTIONS, 8));\n  };\n  CalendarService.ɵprov = /*@__PURE__*/ɵngcc0.ɵɵdefineInjectable({\n    token: CalendarService,\n    factory: function (t) {\n      return CalendarService.ɵfac(t);\n    }\n  });\n  (function () {\n    (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n  })();\n  return CalendarService;\n}();\nexports.CalendarService = CalendarService;\n\n//# sourceMappingURL=calendar.service.js.map","map":null,"metadata":{},"sourceType":"script","externalDependencies":[]}